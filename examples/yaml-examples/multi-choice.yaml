name: Multi-Choice Workflow Example

steps:
  # 1. Select project type
  - choose:
      message: "What type of project are you deploying?"
      options:
        - id: web_app
          label: "Web Application"
        - id: api_service
          label: "API Service"
        - id: microservice
          label: "Microservice"
        - id: monorepo
          label: "Monorepo"
      as: projectType

  # 2. Additional options when Web App is selected
  - when:
      var:
        projectType: web_app
    choose:
      message: "Select frontend framework:"
      options:
        - id: react
          label: "React"
        - id: vue
          label: "Vue"
        - id: angular
          label: "Angular"
        - id: svelte
          label: "Svelte"
      as: frontend

  # 3. Additional options when API Service is selected
  - when:
      var:
        projectType: api_service
    choose:
      message: "Select API framework:"
      options:
        - id: express
          label: "Express.js"
        - id: fastify
          label: "Fastify"
        - id: nestjs
          label: "NestJS"
        - id: koa
          label: "Koa"
      as: apiFramework

  # 4. Additional options when Microservice is selected
  - when:
      var:
        projectType: microservice
    choose:
      message: "Select communication pattern:"
      options:
        - id: rest
          label: "REST API"
        - id: graphql
          label: "GraphQL"
        - id: grpc
          label: "gRPC"
        - id: event_driven
          label: "Event-Driven"
      as: communication

  # 5. Additional options when Monorepo is selected
  - when:
      var:
        projectType: monorepo
    choose:
      message: "Select monorepo tool:"
      options:
        - id: pnpm
          label: "pnpm workspaces"
        - id: yarn
          label: "Yarn workspaces"
        - id: nx
          label: "Nx"
        - id: turborepo
          label: "Turborepo"
      as: monorepoTool

  # 6. Select build tool (common)
  - choose:
      message: "Select build tool:"
      options:
        - id: vite
          label: "Vite"
        - id: webpack
          label: "Webpack"
        - id: esbuild
          label: "esbuild"
        - id: rollup
          label: "Rollup"
        - id: tsc
          label: "TypeScript Compiler"
      as: buildTool

  # 7. Select testing framework
  - choose:
      message: "Select testing framework:"
      options:
        - id: jest
          label: "Jest"
        - id: vitest
          label: "Vitest"
        - id: mocha
          label: "Mocha"
        - id: playwright
          label: "Playwright"
        - id: cypress
          label: "Cypress"
      as: testFramework

  # 8. React + Vite combination
  - when:
      all:
        - var:
            projectType: web_app
        - var:
            frontend: react
        - var:
            buildTool: vite
    run: echo "Setting up React + Vite project..."

  # 9. API Service + Express combination
  - when:
      all:
        - var:
            projectType: api_service
        - var:
            apiFramework: express
    run: echo "Setting up Express.js API..."

  # 10. Microservice + gRPC combination
  - when:
      all:
        - var:
            projectType: microservice
        - var:
            communication: grpc
    run: echo "Setting up gRPC microservice..."

  # 11. Monorepo + Turborepo combination
  - when:
      all:
        - var:
            projectType: monorepo
        - var:
            monorepoTool: turborepo
    run: echo "Setting up Turborepo monorepo..."

  # 12. When Jest or Vitest is selected
  - when:
      any:
        - var:
            testFramework: jest
        - var:
            testFramework: vitest
    run: echo "Configuring unit tests..."

  # 13. When Playwright or Cypress is selected
  - when:
      any:
        - var:
            testFramework: playwright
        - var:
            testFramework: cypress
    run: echo "Configuring E2E tests..."

  # 14. Confirm project setup completion
  - when:
      any:
        - all:
            - var:
                projectType: web_app
            - var:
                frontend: react
        - all:
            - var:
                projectType: api_service
            - var:
                apiFramework: express
        - all:
            - var:
                projectType: microservice
            - var:
                communication: grpc
        - all:
            - var:
                projectType: monorepo
            - var:
                monorepoTool: turborepo
    run: echo "âœ… Project setup completed based on your choices!"

  # 15. Warn if no test configuration
  - when:
      not:
        any:
          - var:
              testFramework: jest
          - var:
              testFramework: vitest
          - var:
              testFramework: playwright
          - var:
              testFramework: cypress
    run: 'echo "Warning: No testing framework configured"'
